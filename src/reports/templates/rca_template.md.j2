# Root Cause Analysis Report

---

| Field | Value |
|-------|-------|
| **Investigation ID** | `{{ id }}` |
| **Status** | {{ status | upper }} |
| **Scenario** | {{ scenario_type }} |
| **Started** | {{ created_at | fmt_timestamp }} |
{% if completed_at %}
| **Completed** | {{ completed_at | fmt_timestamp }} |
{% endif %}
{% if duration_seconds %}
| **Duration** | {{ duration_seconds | fmt_duration }} |
{% endif %}
{% if confidence is not none %}
| **Confidence** | {{ confidence | fmt_percent }} |
{% endif %}

---

## 1. Alert Details

{% if alert %}
- **Service**: {{ alert.get('service', 'N/A') }}
- **Metric**: {{ alert.get('metric', 'N/A') }} = {{ alert.get('value', 'N/A') }}
- **Threshold**: {{ alert.get('threshold', 'N/A') }}
- **Severity**: {{ alert.get('severity', 'N/A') | upper }}
- **Description**: {{ alert.get('description', 'N/A') }}
{% if alert.get('timestamp') %}
- **Alert Time**: {{ alert.get('timestamp') | fmt_timestamp }}
{% endif %}
{% else %}
No alert data available.
{% endif %}

---

## 2. Investigation Plan

{% if plan and plan.get('hypothesis') %}
**Hypothesis**: {{ plan.get('hypothesis') }}

{% if plan.get('tasks') %}
**Investigation Tasks:**
{% for task in plan.get('tasks', []) %}
{{ loop.index }}. {{ task }}
{% endfor %}
{% endif %}

{% if plan.get('priority_services') %}
**Priority Services**: {{ plan.get('priority_services') | join(', ') }}
{% endif %}

{% if plan.get('time_window_start') and plan.get('time_window_end') %}
**Time Window**: {{ plan.get('time_window_start') | fmt_timestamp }} to {{ plan.get('time_window_end') | fmt_timestamp }}
{% endif %}
{% else %}
No investigation plan recorded.
{% endif %}

---

## 3. Agent Findings

{% if findings %}
{% for finding in findings %}
### {{ finding.get('agent_name', 'Unknown Agent') }}

- **Confidence**: {{ finding.get('confidence', 0) | fmt_percent }}
- **Summary**: {{ finding.get('summary', 'No summary available') }}

{% if finding.get('evidence') %}
**Evidence:**
{% for e in finding.get('evidence', []) %}
- {{ e }}
{% endfor %}
{% endif %}

{% if finding.get('relevant_timestamps') %}
**Key Timestamps:**
{% for ts in finding.get('relevant_timestamps', []) %}
- {{ ts | fmt_timestamp }}
{% endfor %}
{% endif %}

{% endfor %}
{% else %}
No agent findings recorded.
{% endif %}

---

## 4. Root Cause

{{ root_cause }}

{% if confidence is not none %}
**Overall Confidence**: {{ confidence | fmt_percent }}
{% endif %}

---

## 5. Recommendation

{{ recommendation }}

{% if remediation_action %}

---

## 6. Remediation Action

{{ remediation_action }}
{% endif %}

{% if agent_errors %}

---

## Errors Encountered

{% for err in agent_errors %}
- {{ err }}
{% endfor %}
{% endif %}

---

## Reasoning Trace

{% if reasoning_trace %}
{% for step in reasoning_trace %}
{{ loop.index }}. {{ step }}
{% endfor %}
{% else %}
No reasoning trace recorded.
{% endif %}

---

*Report generated by System Failures AI Agent*